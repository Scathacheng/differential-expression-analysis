library(DESeq2)
library(edgeR)
library(GenomicAlignments)

#DESeq2
# datExpr<-t(datExpr)
# datExpr2<-as.integer(datExpr)
# dim(datExpr2)=dim(datExpr)
# dimnames(datExpr2)=dimnames(datExpr)
# datExpr是矩阵，sample是样本信息的矩阵
# DESeqDataSetFromMatrix是GenomicAlignments包的类似“singlecellexperiment”的数据集合
dds<-DESeqDataSetFromMatrix(countData=datExpr,colData=sample,design=~Rate_Of_Death)
dds<-DESeq(dds)
res<-results(dds)
summary(res)

#edgeR
genetable<-data.frame(gene.id=rownames(datExpr))
dge<-DGEList(counts=datExpr,samples=sample,genes=genetable)
design<-model.matrix(~agonal,dge$samples)
dge<-calcNormFactors(dge)
dge<-estimateDisp(dge,design)
fit<-glmFit(dge,design)
lrt<-glmLRT(fit,coef=ncol(design))
tt<-topTags(lrt,n=nrow(dge),p.value=0.1)
tt10<-topTags(lrt)

#compare two result
tt.all<-topTags(lrt,n=nrow(dge),sort.by="none")
table(DESeq2=res$padj<0.1,edgeR=tt.all$table$FDR<0.1)

